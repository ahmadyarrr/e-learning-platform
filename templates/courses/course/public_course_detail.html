{% extends 'base/base.html' %}
{% load account allauth %}
{% block title %}
  {{ object.title }}
{% endblock %}
{% block head %}
  <style>
    a {
      text-decoration: none;
    }
  </style>
{% endblock %}
{% block body %}
  {% with subject=object.subject %}
    <h1>{{ object.title }}</h1>
    <div class="module">
      <h2>Overview</h2>
      <p>
        <a href="{% url 'subject_courses' subject.slug %}">{{ subject.title }}</a>.
        {{ object.modules.count }} modules. Instructor: {{ object.instructor.username }}
      </p>
      {{ object.description|linebreaks }}
      {% if not request.user.instructor_profile %} <!--user is not instructor-->
        {% if request.user.is_authenticated %} <!--user has logged in-->
            {% if not request.user in object.students.all %} <!--user is not enrolled-->
              <form method="post" action="{% url 'course:enroll_student' %}">
                {% csrf_token %}
                {{ enroll_form.as_p }}
                <input type="submit" value="Enroll" class="btn btn-primary" />
              </form>
            {% else %} <!--user is enrolled-->
              <p>You are enrolled in this course</p>
            <br />
            <a class="btn btn-success" href="{% url 'students:student_course_detail' object.id %}">See Modules</a>
            {% endif %}
        {% else %} <!--user is not logged in-->
          <a class="btn btn-success" href="{% url 'account_login' %}?next={% url 'course:course_detail' object.slug %}">Login And Enroll</a>
        {% endif %}
      {% endif %} <!--user is an instructor-->
    </div>
  {% endwith %}
{% endblock %}
